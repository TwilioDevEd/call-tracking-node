<!DOCTYPE html><html><head><title>Call Tracking</title><style>body, html {
  height:100%;
  width:100%;
  padding:0;
  margin:0;
  overflow:hidden;
  background-color:#ddd;
}
.wrapper {
  height:100%;
  width:100%;
}</style><link rel="shortcut icon" href="//twilio.com/bundles/marketing/img/favicons/favicon.ico"><link rel="apple-touch-icon" href="//twilio.com/bundles/marketing/img/favicons/favicon_57.png"><link rel="apple-touch-icon" sizes="72x72" href="//twilio.com/bundles/marketing/img/favicons/favicon_72.png"><link rel="apple-touch-icon" sizes="114x114" href="//twilio.com/bundles/marketing/img/favicons/favicon_114.png"><link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css"><link rel="stylesheet" href="viewsaurus.css"></head><body><div class="wrapper"><div id="viewsaurus" data-title="Call Tracking"><div class="saurus-panes"><div class="saurus-prose"><div class="saurus-prose-header"><div class="title-outer"><span class="step-title">Call Tracking</span></div></div><div class="saurus-nav-buttons"><div class="saurus-nav-button nav-overview"><div class="saurus-nav-button-inner"><i class="fa fa-fw fa-list"></i></div><div class="nav-divider"></div></div><div class="saurus-nav-button nav-previous"><div class="saurus-nav-button-inner"><a href=""> <i class="fa fa-fw fa-play fa-rotate-180"></i></a></div><div class="nav-divider"></div></div><div class="saurus-nav-button nav-next clickable"><div class="saurus-nav-button-inner"><a href="#1"> <i class="fa fa-fw fa-play"></i></a></div></div><div class="saurus-next-title"><span class="next-title-inner"></span></div></div><div class="saurus-progress-bar"></div><div class="saurus-start"><p>Use Twilio to track the effectiveness of your marketing campaigns. Let's get started!</p><a href="#0">Start Tutorial</a></div><div class="saurus-content"><div data-title="Call Tracking with Twilio, Node.js and Express " class="chapter"><div data-file="index.js" class="step"><h2 id="what-does-this-thing-do-">What does this thing do?</h2>
<p>This <a href="//expressjs.com/">Express.js</a> web application shows
how you can use Twilio to track the effectiveness of different
marketing channels.</p>
<p><img src="//howtodocs.s3.amazonaws.com/call-tracking-home.png" alt="//howtodocs.s3.amazonaws.com/call-tracking-home.png"></p>
<p>This application has three main features:</p>
<ul>
<li>It purchases phone numbers from Twilio to use in different marketing
campaigns (like a billboard or a bus advertisement)</li>
<li>It forwards incoming calls for those phone numbers to a salesperson</li>
<li>It displays charts showing data about the phone numbers and the calls
they receive</li>
</ul>
<p>In this tutorial, we&#39;ll point out the key bits of code that make
this application work.  <a href="//github.com/twiliodeved/call-tracking-node">Check out the project README on
GitHub</a> to
see how to run the code yourself.</p>
<p>Let&#39;s get started! Click the right arrow above to advance to the next
code snippet.</p>
<hr>
<p><strong>See also:</strong></p>
<ul>
<li><a href="//twilio.github.io/twilio-node/">Twilio Node Helper Library</a></li>
<li><a href="//www.twilio.com/docs/api">Twilio REST API docs</a></li>
<li><a href="//expressjs.com/starter/installing.html">Getting started with Express.js</a></li>
<li><a href="//docs.mongodb.org/manual/">Getting started with MongoDB</a></li>
<li><a href="//mongoosejs.com/docs/index.html">Mongoose quickstart</a></li>
<li><a href="//www.searchenginejournal.com/seo-beginner-guide-call-tracking-care/83173/">What is Call Tracking?</a></li>
</ul>
</div><div data-file="controllers/availableNumbers.js" class="step"><h2 id="search-for-available-phone-numbers">Search for available phone numbers</h2>
<p>Call tracking requires us to search for and buy phone numbers on
demand, associating a specific phone number with a lead
source. From the dashboard, the user can search for new numbers, optionally
filtering by area code.</p>
<hr>
<p><strong>See also:</strong></p>
<ul>
<li><a href="//twilio.github.io/twilio-node/">Twilio Node Helper Library</a></li>
<li><a href="//twilio.github.io/twilio-node/#callbacks">Callbacks versus Promises</a></li>
<li><a href="//twilio.github.io/twilio-node/#moreexamples">Twilio Node examples</a></li>
<li><a href="//www.twilio.com/docs/api/rest/available-phone-numbers">REST API: Available Phone Numbers</a></li>
</ul>
</div><div data-file="views/availableNumbers.jade" class="step"><h2 id="display-available-phone-numbers">Display available phone numbers</h2>
<p>After a user searches for phone numbers from the dashboard, we display a
list of numbers that are currently available for purchase. Submitting one
of the forms generated for a number will buy that phone number.</p>
<hr>
<p><strong>See also:</strong></p>
<ul>
<li><a href="//jade-lang.com/">Jade template engine</a></li>
<li><a href="//jade-lang.com/reference/">Jade language reference</a></li>
<li><a href="//expressjs.com/guide/using-template-engines.html">Using template engines with Express</a></li>
</ul>
</div><div data-file="controllers/leadSources.js" data-highlight="5-25" class="step"><h2 id="buy-a-phone-number">Buy a phone number</h2>
<p>The <code>create</code> function for the LeadSource resource expects a phone
number as a parameter, and purchases a number through Twilio&#39;s
API on behalf of this application&#39;s user. It enables the caller
ID feature and associates the number with the current TwiML app
SID. It immediately redirects the user so she can add a
forwarding number and a description for the lead source.</p>
<hr>
<p><strong>See also:</strong></p>
<ul>
<li><a href="//www.twilio.com/docs/api/rest/available-phone-numbers">Twilio REST API: Available Phone Numbers</a></li>
<li><a href="//twilio.github.io/twilio-node/#moreexamples">Twilio Node examples</a></li>
<li><a href="//mongoosejs.com/docs/api.html#model_Model-save">Save models with Mongoose</a></li>
</ul>
</div><div data-file="controllers/leadSources.js" data-highlight="30-40" class="step"><h2 id="associate-a-phone-number-with-a-lead-source">Associate a phone number with a lead source</h2>
<p>Once we have bought a number we display a form so the user can
add a forwarding number and a description for this number. From
now on, any call to this number will be attributed to this
source. All phone numbers should be in E.164 format.</p>
<hr>
<p><strong>See also:</strong></p>
<ul>
<li><a href="//mongoosejs.com/docs/queries.html">Mongoose queries</a></li>
<li><a href="//github.com/jadejs/jade/blob/master/examples/form.jade">Forms with Jade</a></li>
<li><a href="//expressjs.com/api.html">Express.js API documentation</a></li>
<li><a href="//en.wikipedia.org/wiki/E.164">E.164 format</a></li>
</ul>
</div><div data-file="models/LeadSource.js" class="step"><h2 id="the-leadsource-model">The LeadSource model</h2>
<p>This is the model that contains the information provided in the
form from the previous step. The <code>LeadSource</code> model associates a
Twilio number to a named lead source (like &quot;Wall Street Journal
Ad&quot; or &quot;Dancing guy with sign&quot;). It also tracks a phone number
to which we&#39;d like all the calls redirected, like your sales or
support help line.</p>
<hr>
<p><strong>See also:</strong></p>
<ul>
<li><a href="//mongoosejs.com/docs/models.html">Mongoose models</a></li>
<li><a href="//mongoosejs.com/docs/populate.html">Mongoose populate</a></li>
<li><a href="//mongoosejs.com/docs/schematypes.html">Mongoose schema types</a></li>
</ul>
</div><div data-file="models/Lead.js" class="step"><h2 id="the-lead-model">The Lead model</h2>
<p>A <code>Lead</code> represents a phone call generated by a
<code>LeadSource</code>. Each time somebody calls a phone number associated
with a <code>LeadSource</code>, we&#39;ll use the <code>Lead</code> model to record some
of the <a href="//www.twilio.com/docs/api/twiml/twilio_request">data Twilio gives
us</a> about
their call.</p>
<hr>
<p><strong>See also:</strong></p>
<ul>
<li><a href="//mongoosejs.com/docs/models.html">Mongoose models</a></li>
<li><a href="//mongoosejs.com/docs/populate.html">Mongoose populate</a></li>
<li><a href="//mongoosejs.com/docs/schematypes.html">Mongoose schema types</a></li>
</ul>
</div><div data-file="controllers/leads.js" data-highlight="8-32" class="step"><h2 id="forward-calls-and-create-leads">Forward calls and create leads</h2>
<p>Whenever a customer calls one of our Twilio numbers, Twilio will
send a POST request to the URL associated with this view
function (should be <code>/lead</code>).</p>
<p>We use the incoming call data to create a new <code>Lead</code> for a
<code>LeadSource</code>, then return
<a href="//www.twilio.com/docs/api/twiml">TwiML</a> that connects our
caller with the <code>forwarding_number</code> of our <code>LeadSource</code>.</p>
<hr>
<p><strong>See also:</strong></p>
<ul>
<li><a href="//www.twilio.com/docs/api/twiml/twilio_request">Twilio voice request parameters</a></li>
<li><a href="//twilio.github.io/twilio-node/#twimlBasic">TwiML basics with twilio-node</a></li>
<li><a href="//www.twilio.com/docs/api/twiml/dial">TwiML &lt;Dial&gt; verb</a></li>
</ul>
</div><div data-file="controllers/leads.js" data-highlight="34-51" class="step"><h2 id="get-statistics-about-our-lead-sources">Get statistics about our lead sources</h2>
<p>One useful statistic we can get from our data is how many calls
each <code>LeadSource</code> has received. We might also want to know the
cities the leads are coming from. For this we define two
functions which will be mapped to routes the front-end can call.</p>
<hr>
<p><strong>See also:</strong></p>
<ul>
<li><a href="//mongoosejs.com/docs/populate.html">Mongoose population</a></li>
<li><a href="//underscorejs.org/">Underscore.js</a></li>
<li><a href="//underscorejs.org/#countBy">Underscore.js countBy</a></li>
</ul>
</div><div data-file="public/js/pieCharts.js" class="step"><h2 id="visualize-our-statistics-with-chart-js">Visualize our statistics with Chart.js</h2>
<p>Back on the home page, we fetch call tracking statistics in JSON
from the server using
<a href="//api.jquery.com/jquery.get/">jQuery</a>.  We display the
stats in colorful pie charts we create with
<a href="//www.chartjs.org/">Chart.js</a>. We also use some utility functions
from <a href="//underscorejs.org/">Underscore.js</a> to munge the data from
our back-end.</p>
</div><div class="step"><h2 id="where-to-next-">Where to next?</h2>
<p>That&#39;s it! Our Express.js application is now ready to purchase new phone
numbers, forward incoming calls, and record some statistics for our
business. </p>
<p>If you&#39;re a Node.js developer working with Twilio, you might also enjoy these
tutorials:</p>
<p><a href="//www.twilio.com/docs/howto/walkthrough/click-to-call/node/express"><strong>Click-To-Call (Node.js)</strong></a></p>
<p>Put a button on your web page that connects visitors to live
support or sales people via telephone.</p>
<p><a href="//www.twilio.com/docs/howto/walkthrough/two-factor-authentication/node/express"><strong>Two Factor Authentication with Authy (Node.js)</strong></a></p>
<p>Learn to implement account verification in your web app with
Twilio-powered Authy.</p>
<p>Thanks for checking out this tutorial! If you have any feedback to share
with us, we&#39;d love to hear it. Tweet <a href="//twitter.com/twilio">@twilio</a>
to let us know what you think.</p>
</div></div>
<div class="saurus-files" style="display:none;"><textarea class="saurus-file" data-file="index.js" data-mode="javascript">dmFyIGh0dHAgPSByZXF1aXJlKCdodHRwJyk7CnZhciBtb25nb29zZSA9IHJlcXVpcmUoJ21vbmdvb3NlJyk7CnZhciBjb25maWcgPSByZXF1aXJlKCcuL2NvbmZpZycpOwoKLy8gSW5pdGlhbGl6ZSBkYXRhYmFzZSBjb25uZWN0aW9uIC0gdGhyb3dzIGlmIGRhdGFiYXNlIGNvbm5lY3Rpb24gY2FuJ3QgYmUKLy8gZXN0YWJsaXNoZWQKbW9uZ29vc2UuY29ubmVjdChjb25maWcubW9uZ29VcmwpOwoKLy8gQ3JlYXRlIEV4cHJlc3Mgd2ViIGFwcAp2YXIgYXBwID0gcmVxdWlyZSgnLi93ZWJhcHAnKTsKCi8vIENyZWF0ZSBhbiBIVFRQIHNlcnZlciBhbmQgbGlzdGVuIG9uIHRoZSBjb25maWd1cmVkIHBvcnQKdmFyIHNlcnZlciA9IGh0dHAuY3JlYXRlU2VydmVyKGFwcCk7CnNlcnZlci5saXN0ZW4oY29uZmlnLnBvcnQsIGZ1bmN0aW9uKCkgewogIGNvbnNvbGUubG9nKCdFeHByZXNzIHNlcnZlciBsaXN0ZW5pbmcgb24gKjonICsgY29uZmlnLnBvcnQpOwp9KTsK</textarea>
<textarea class="saurus-file" data-file="controllers/availableNumbers.js" data-mode="javascript">dmFyIHR3aWxpbyA9IHJlcXVpcmUoJ3R3aWxpbycpOwp2YXIgY29uZmlnID0gcmVxdWlyZSgnLi4vY29uZmlnJyk7Cgp2YXIgY2xpZW50ID0gdHdpbGlvKGNvbmZpZy5hY2NvdW50U2lkLCBjb25maWcuYXV0aFRva2VuKTsKCmV4cG9ydHMuaW5kZXggPSBmdW5jdGlvbihyZXF1ZXN0LCByZXNwb25zZSkgewoKICB2YXIgYXJlYUNvZGUgPSByZXF1ZXN0LnF1ZXJ5LmFyZWFDb2RlOwoKICBjbGllbnQuYXZhaWxhYmxlUGhvbmVOdW1iZXJzKCdVUycpLmxvY2FsLmxpc3QoewogICAgYXJlYUNvZGU6IGFyZWFDb2RlCiAgfSkudGhlbihmdW5jdGlvbihhdmFpbGFibGVOdW1iZXJzKSB7CiAgICByZXNwb25zZS5yZW5kZXIoJ2F2YWlsYWJsZU51bWJlcnMnLCB7CiAgICAgIGF2YWlsYWJsZU51bWJlcnM6IGF2YWlsYWJsZU51bWJlcnMKICAgIH0pOwogIH0pLmNhdGNoKGZ1bmN0aW9uKGZhaWx1cmVUb0ZldGNoTnVtYmVycykgewogICAgY29uc29sZS5sb2coJ0ZhaWxlZCB0byBmZXRjaCBudW1iZXJzIGZyb20gQVBJJyk7CiAgICBjb25zb2xlLmxvZygnRXJyb3Igd2FzOicpOwogICAgY29uc29sZS5sb2coZmFpbHVyZVRvRmV0Y2hOdW1iZXJzKTsKICAgIHJlc3BvbnNlLnN0YXR1cyg1MDApLnNlbmQoJ0NvdWxkIG5vdCBjb250YWN0IFR3aWxpbyBBUEknKTsKICB9KTsKfTsK</textarea>
<textarea class="saurus-file" data-file="views/availableNumbers.jade" data-mode="jade">ZXh0ZW5kcyBsYXlvdXQKCmJsb2NrIGNvbnRlbnQKICAucm93CiAgICAuY29sLWxnLTQKICAgICAgdGFibGUudGFibGUKICAgICAgICB0aGVhZAogICAgICAgICAgdHIKICAgICAgICAgICAgdGggUGhvbmUgbnVtYmVyCiAgICAgICAgICAgIHRoIFN0YXRlCiAgICAgICAgICAgIHRoCiAgICAgICAgdGJvZHkKICAgICAgICAgIGVhY2ggbnVtYmVyIGluIGF2YWlsYWJsZU51bWJlcnMKICAgICAgICAgICAgdHIKICAgICAgICAgICAgICB0ZD0gbnVtYmVyLmZyaWVuZGx5TmFtZQogICAgICAgICAgICAgIHRkPSBudW1iZXIucmVnaW9uCiAgICAgICAgICAgICAgdGQKICAgICAgICAgICAgICAgIGZvcm0obmFtZT0ncHVyY2hhc2VOdW1iZXInLCBhY3Rpb249Jy9sZWFkLXNvdXJjZScsIG1ldGhvZD0nUE9TVCcpCiAgICAgICAgICAgICAgICAgIGlucHV0KHR5cGU9J2hpZGRlbicsIG5hbWU9J3Bob25lTnVtYmVyJywgdmFsdWU9IiN7bnVtYmVyLnBob25lTnVtYmVyfSIpCiAgICAgICAgICAgICAgICAgIGlucHV0KHR5cGU9J2hpZGRlbicsIG5hbWU9J19jc3JmJywgdmFsdWU9IiN7Y3NyZnRva2VufSIpCiAgICAgICAgICAgICAgICAgIGlucHV0KHR5cGU9J3N1Ym1pdCcsIHZhbHVlPSdQdXJjaGFzZScpLmJ0bi5idG4tc20uYnRuLXByaW1hcnkK</textarea>
<textarea class="saurus-file" data-file="controllers/leadSources.js" data-mode="javascript">dmFyIHR3aWxpbyA9IHJlcXVpcmUoJ3R3aWxpbycpOwp2YXIgY29uZmlnID0gcmVxdWlyZSgnLi4vY29uZmlnJyk7CnZhciBMZWFkU291cmNlID0gcmVxdWlyZSgnLi4vbW9kZWxzL0xlYWRTb3VyY2UnKTsKCnZhciBjbGllbnQgPSB0d2lsaW8oY29uZmlnLmFjY291bnRTaWQsIGNvbmZpZy5hdXRoVG9rZW4pOwoKZXhwb3J0cy5jcmVhdGUgPSBmdW5jdGlvbihyZXF1ZXN0LCByZXNwb25zZSkgewogIHZhciBwaG9uZU51bWJlclRvUHVyY2hhc2UgPSByZXF1ZXN0LmJvZHkucGhvbmVOdW1iZXI7CgogIGNsaWVudC5pbmNvbWluZ1Bob25lTnVtYmVycy5jcmVhdGUoewogICAgcGhvbmVOdW1iZXI6IHBob25lTnVtYmVyVG9QdXJjaGFzZSwKICAgIHZvaWNlQ2FsbGVySWRMb29rdXA6ICd0cnVlJywKICAgIHZvaWNlQXBwbGljYXRpb25TaWQ6IGNvbmZpZy5hcHBTaWQKICB9KS50aGVuKGZ1bmN0aW9uKHB1cmNoYXNlZE51bWJlcikgewogICAgdmFyIGxlYWRTb3VyY2UgPSBuZXcgTGVhZFNvdXJjZSh7bnVtYmVyOiBwdXJjaGFzZWROdW1iZXIucGhvbmVOdW1iZXJ9KTsKICAgIHJldHVybiBsZWFkU291cmNlLnNhdmUoKTsKICB9KS50aGVuKGZ1bmN0aW9uKHNhdmVkTGVhZFNvdXJjZSkgewogICAgY29uc29sZS5sb2coJ1NhdmluZyBsZWFkIHNvdXJjZScpOwogICAgcmVzcG9uc2UucmVkaXJlY3QoMzAzLCAnL2xlYWQtc291cmNlLycgKyBzYXZlZExlYWRTb3VyY2UuX2lkICsgJy9lZGl0Jyk7CiAgfSkuY2F0Y2goZnVuY3Rpb24obnVtYmVyUHVyY2hhc2VGYWlsdXJlKSB7CiAgICBjb25zb2xlLmxvZygnQ291bGQgbm90IHB1cmNoYXNlIGEgbnVtYmVyIGZvciBsZWFkIHNvdXJjZTonKTsKICAgIGNvbnNvbGUubG9nKG51bWJlclB1cmNoYXNlRmFpbHVyZSk7CiAgICByZXNwb25zZS5zdGF0dXMoNTAwKS5zZW5kKCdDb3VsZCBub3QgY29udGFjdCBUd2lsaW8gQVBJJyk7CiAgfSk7Cn07CgpleHBvcnRzLmVkaXQgPSBmdW5jdGlvbihyZXF1ZXN0LCByZXNwb25zZSkgewogIHZhciBsZWFkU291cmNlSWQgPSByZXF1ZXN0LnBhcmFtcy5pZDsKICBMZWFkU291cmNlLmZpbmRPbmUoe19pZDogbGVhZFNvdXJjZUlkfSkudGhlbihmdW5jdGlvbihmb3VuZExlYWRTb3VyY2UpIHsKICAgIHJldHVybiByZXNwb25zZS5yZW5kZXIoJ2VkaXRMZWFkU291cmNlJywgewogICAgICBsZWFkU291cmNlSWQ6IGZvdW5kTGVhZFNvdXJjZS5faWQsCiAgICAgIGxlYWRTb3VyY2VQaG9uZU51bWJlcjogZm91bmRMZWFkU291cmNlLm51bWJlciwKICAgICAgbGVhZFNvdXJjZUZvcndhcmRpbmdOdW1iZXI6IGZvdW5kTGVhZFNvdXJjZS5mb3J3YXJkaW5nTnVtYmVyLAogICAgICBsZWFkU291cmNlRGVzY3JpcHRpb246IGZvdW5kTGVhZFNvdXJjZS5kZXNjcmlwdGlvbiwKICAgICAgbWVzc2FnZXM6IHJlcXVlc3QuZmxhc2goJ2Vycm9yJykKICAgIH0pOwogIH0pLmNhdGNoKGZ1bmN0aW9uKCkgewogICAgcmV0dXJuIHJlc3BvbnNlLnN0YXR1cyg0MDQpLnNlbmQoJ05vIHN1Y2ggbGVhZCBzb3VyY2UnKTsKICB9KTsKfTsKCmV4cG9ydHMudXBkYXRlID0gZnVuY3Rpb24ocmVxdWVzdCwgcmVzcG9uc2UpIHsKICB2YXIgbGVhZFNvdXJjZUlkID0gcmVxdWVzdC5wYXJhbXMuaWQ7CgogIHJlcXVlc3QuY2hlY2tCb2R5KCdkZXNjcmlwdGlvbicsICdEZXNjcmlwdGlvbiBjYW5ub3QgYmUgZW1wdHknKS5ub3RFbXB0eSgpOwogIHJlcXVlc3QuY2hlY2tCb2R5KCdmb3J3YXJkaW5nTnVtYmVyJywgJ0ZvcndhcmRpbmcgbnVtYmVyIGNhbm5vdCBiZSBlbXB0eScpCiAgICAubm90RW1wdHkoKTsKCiAgaWYgKHJlcXVlc3QudmFsaWRhdGlvbkVycm9ycygpKSB7CiAgICByZXF1ZXN0LmZsYXNoKCdlcnJvcicsIHJlcXVlc3QudmFsaWRhdGlvbkVycm9ycygpKTsKICAgIHJldHVybiByZXNwb25zZS5yZWRpcmVjdCgzMDMsICcvbGVhZC1zb3VyY2UvJyArIGxlYWRTb3VyY2VJZCArICcvZWRpdCcpOwogIH0KCiAgTGVhZFNvdXJjZS5maW5kT25lKHtfaWQ6IGxlYWRTb3VyY2VJZH0pLnRoZW4oZnVuY3Rpb24oZm91bmRMZWFkU291cmNlKSB7CiAgICBmb3VuZExlYWRTb3VyY2UuZGVzY3JpcHRpb24gPSByZXF1ZXN0LmJvZHkuZGVzY3JpcHRpb247CiAgICBmb3VuZExlYWRTb3VyY2UuZm9yd2FyZGluZ051bWJlciA9IHJlcXVlc3QuYm9keS5mb3J3YXJkaW5nTnVtYmVyOwoKICAgIHJldHVybiBmb3VuZExlYWRTb3VyY2Uuc2F2ZSgpOwogIH0pLnRoZW4oZnVuY3Rpb24oc2F2ZWRMZWFkU291cmNlKSB7CiAgICByZXR1cm4gcmVzcG9uc2UucmVkaXJlY3QoMzAzLCAnL2Rhc2hib2FyZCcpOwogIH0pLmNhdGNoKGZ1bmN0aW9uKGVycm9yKSB7CiAgICByZXR1cm4gcmVzcG9uc2Uuc3RhdHVzKDUwMCkuc2VuZCgnQ291bGQgbm90IHNhdmUgdGhlIGxlYWQgc291cmNlJyk7CiAgfSk7Cn07Cg==</textarea>
<textarea class="saurus-file" data-file="models/LeadSource.js" data-mode="javascript">dmFyIG1vbmdvb3NlID0gcmVxdWlyZSgnbW9uZ29vc2UnKTsKCnZhciBMZWFkU291cmNlU2NoZW1hID0gbmV3IG1vbmdvb3NlLlNjaGVtYSh7CiAgbnVtYmVyOiB7CiAgICB0eXBlOiBTdHJpbmcsCiAgICByZXF1aXJlZDogdHJ1ZQogIH0sCiAgZGVzY3JpcHRpb246IHsKICAgIHR5cGU6IFN0cmluZywKICAgIHJlcXVpcmVkOiBmYWxzZQogIH0sCiAgZm9yd2FyZGluZ051bWJlcjogewogICAgdHlwZTogU3RyaW5nLAogICAgcmVxdWlyZWQ6IGZhbHNlCiAgfQp9KTsKCmRlbGV0ZSBtb25nb29zZS5tb2RlbHMuTGVhZFNvdXJjZQoKLy8gQ3JlYXRlIGEgTW9uZ29vc2UgbW9kZWwgZnJvbSBvdXIgc2NoZW1hCnZhciBMZWFkU291cmNlID0gbW9uZ29vc2UubW9kZWwoJ0xlYWRTb3VyY2UnLCBMZWFkU291cmNlU2NoZW1hKTsKCi8vIGV4cG9ydCBtb2RlbCBhcyBvdXIgbW9kdWxlIGludGVyZmFjZQptb2R1bGUuZXhwb3J0cyA9IExlYWRTb3VyY2U7Cg==</textarea>
<textarea class="saurus-file" data-file="models/Lead.js" data-mode="javascript">dmFyIG1vbmdvb3NlID0gcmVxdWlyZSgnbW9uZ29vc2UnKTsKCnZhciBMZWFkU2NoZW1hID0gbmV3IG1vbmdvb3NlLlNjaGVtYSh7CiAgY2FsbGVyTnVtYmVyOiB7CiAgICB0eXBlOiBTdHJpbmcsCiAgICByZXF1aXJlZDogdHJ1ZQogIH0sCiAgY2FsbFNpZDogewogICAgdHlwZTogU3RyaW5nLAogICAgcmVxdWlyZWQ6IHRydWUKICB9LAogIGxlYWRTb3VyY2U6IHsKICAgIHR5cGU6IG1vbmdvb3NlLlNjaGVtYS5UeXBlcy5PYmplY3RJZCwKICAgIHJlZjogJ0xlYWRTb3VyY2UnCiAgfSwKICBjaXR5OiB7CiAgICB0eXBlOiBTdHJpbmcsCiAgICByZXF1aXJlZDogZmFsc2UKICB9LAogIHN0YXRlOiB7CiAgICB0eXBlOiBTdHJpbmcsCiAgICByZXF1aXJlZDogZmFsc2UKICB9LAogIGNhbGxlck5hbWU6IHsKICAgIHR5cGU6IFN0cmluZywKICAgIHJlcXVpcmVkOiBmYWxzZQogIH0KfSk7CgpkZWxldGUgbW9uZ29vc2UubW9kZWxzLkxlYWQKCi8vIENyZWF0ZSBhIE1vbmdvb3NlIG1vZGVsIGZyb20gb3VyIHNjaGVtYQp2YXIgTGVhZCA9IG1vbmdvb3NlLm1vZGVsKCdMZWFkJywgTGVhZFNjaGVtYSk7CgovLyBleHBvcnQgbW9kZWwgYXMgb3VyIG1vZHVsZSBpbnRlcmZhY2UKbW9kdWxlLmV4cG9ydHMgPSBMZWFkOwo=</textarea>
<textarea class="saurus-file" data-file="controllers/leads.js" data-mode="javascript">dmFyIHR3aWxpbyA9IHJlcXVpcmUoJ3R3aWxpbycpOwp2YXIgXyA9IHJlcXVpcmUoJ3VuZGVyc2NvcmUnKTsKCnZhciBMZWFkU291cmNlID0gcmVxdWlyZSgnLi4vbW9kZWxzL0xlYWRTb3VyY2UnKTsKdmFyIExlYWQgPSByZXF1aXJlKCcuLi9tb2RlbHMvTGVhZCcpOwp2YXIgY29uZmlnID0gcmVxdWlyZSgnLi4vY29uZmlnJyk7CgpleHBvcnRzLmNyZWF0ZSA9IGZ1bmN0aW9uKHJlcXVlc3QsIHJlc3BvbnNlKSB7CiAgdmFyIGxlYWRTb3VyY2VOdW1iZXIgPSByZXF1ZXN0LmJvZHkuVG87CgogIExlYWRTb3VyY2UuZmluZE9uZSh7CiAgICBudW1iZXI6IGxlYWRTb3VyY2VOdW1iZXIKICB9KS50aGVuKGZ1bmN0aW9uKGZvdW5kTGVhZFNvdXJjZSkgewogICAgdmFyIHR3aW1sID0gbmV3IHR3aWxpby5Ud2ltbFJlc3BvbnNlKCk7CiAgICB0d2ltbC5kaWFsKGZvdW5kTGVhZFNvdXJjZS5mb3J3YXJkaW5nTnVtYmVyKTsKCiAgICB2YXIgbmV3TGVhZCA9IG5ldyBMZWFkKHsKICAgICAgY2FsbGVyTnVtYmVyOiByZXF1ZXN0LmJvZHkuRnJvbSwKICAgICAgY2FsbFNpZDogcmVxdWVzdC5ib2R5LkNhbGxTaWQsCiAgICAgIGxlYWRTb3VyY2U6IGZvdW5kTGVhZFNvdXJjZS5faWQsCiAgICAgIGNpdHk6IHJlcXVlc3QuYm9keS5Gcm9tQ2l0eSwKICAgICAgc3RhdGU6IHJlcXVlc3QuYm9keS5Gcm9tU3RhdGUsCiAgICAgIGNhbGxlck5hbWU6IHJlcXVlc3QuYm9keS5DYWxsZXJOYW1lCiAgICB9KTsKICAgIHJldHVybiBuZXdMZWFkLnNhdmUoKQogICAgLnRoZW4oZnVuY3Rpb24oKSB7CiAgICAgIHJlc3BvbnNlLnNlbmQodHdpbWwudG9TdHJpbmcoKSk7CiAgICB9KTsKICB9KS5jYXRjaChmdW5jdGlvbihlcnIpIHsKICAgIGNvbnNvbGUubG9nKCdGYWlsZWQgdG8gZm9yd2FyZCBjYWxsOicpOwogICAgY29uc29sZS5sb2coZXJyKTsKICB9KTsKfTsKCmV4cG9ydHMubGVhZHNCeUxlYWRTb3VyY2UgPSBmdW5jdGlvbihyZXF1ZXN0LCByZXNwb25zZSkgewogIExlYWQuZmluZCgpCiAgICAucG9wdWxhdGUoJ2xlYWRTb3VyY2UnKQogICAgLnRoZW4oZnVuY3Rpb24oZXhpc3RpbmdMZWFkcykgewogICAgICB2YXIgc3RhdHNCeUxlYWRTb3VyY2UgPSBfLmNvdW50QnkoZXhpc3RpbmdMZWFkcywgZnVuY3Rpb24obGVhZCkgewogICAgICAgICAgcmV0dXJuIGxlYWQubGVhZFNvdXJjZS5kZXNjcmlwdGlvbjsKICAgICAgfSk7CgogICAgICByZXNwb25zZS5zZW5kKHN0YXRzQnlMZWFkU291cmNlKTsKICAgIH0pOwp9OwoKZXhwb3J0cy5sZWFkc0J5Q2l0eSA9IGZ1bmN0aW9uKHJlcXVlc3QsIHJlc3BvbnNlKSB7CiAgTGVhZC5maW5kKCkudGhlbihmdW5jdGlvbihleGlzdGluZ0xlYWRzKSB7CiAgICB2YXIgc3RhdHNCeUNpdHkgPSBfLmNvdW50QnkoZXhpc3RpbmdMZWFkcywgJ2NpdHknKTsKICAgIHJlc3BvbnNlLnNlbmQoc3RhdHNCeUNpdHkpOwogIH0pOwp9Owo=</textarea>
<textarea class="saurus-file" data-file="public/js/pieCharts.js" data-mode="javascript">CiQuZ2V0SlNPTignL2xlYWQvc3VtbWFyeS1ieS1sZWFkLXNvdXJjZScsIGZ1bmN0aW9uKHJlc3VsdHMpIHsKICByZXN1bHRzID0gXy5tYXAoXy56aXAoXy5rZXlzKHJlc3VsdHMpLCBfLnZhbHVlcyhyZXN1bHRzKSksIGZ1bmN0aW9uKHZhbHVlKSB7CiAgICByZXR1cm4gewogICAgICBkZXNjcmlwdGlvbjogdmFsdWVbMF0sIAogICAgICBsZWFkX2NvdW50OiB2YWx1ZVsxXQogICAgfTsKICB9KTsKCiAgc3VtbWFyeUJ5TGVhZFNvdXJjZURhdGEgPSBfLm1hcChyZXN1bHRzLCBmdW5jdGlvbihsZWFkU291cmNlRGF0YVBvaW50KSB7CiAgICByZXR1cm4gewogICAgICB2YWx1ZTogbGVhZFNvdXJjZURhdGFQb2ludC5sZWFkX2NvdW50LAogICAgICBjb2xvcjogJ2hzbCgnICsgKDE4MCAqIGxlYWRTb3VyY2VEYXRhUG9pbnQubGVhZF9jb3VudC8gcmVzdWx0cy5sZW5ndGgpIAogICAgICAgICsgJywgMTAwJSwgNTAlKScsCiAgICAgIGxhYmVsOiBsZWFkU291cmNlRGF0YVBvaW50LmRlc2NyaXB0aW9uCiAgICB9OwogIH0pOwoKICB2YXIgYnlMZWFkU291cmNlQ29udGV4dCA9ICQoIiNwaWUtYnktbGVhZC1zb3VyY2UiKS5nZXQoMCkuZ2V0Q29udGV4dCgiMmQiKTsKICB2YXIgYnlMZWFkU291cmNlQ2hhcnQgPSAKICAgIG5ldyBDaGFydChieUxlYWRTb3VyY2VDb250ZXh0KS5QaWUoc3VtbWFyeUJ5TGVhZFNvdXJjZURhdGEpOwp9KTsKCiQuZ2V0SlNPTignL2xlYWQvc3VtbWFyeS1ieS1jaXR5JywgZnVuY3Rpb24ocmVzdWx0cykgewogIHJlc3VsdHMgPSBfLm1hcChfLnppcChfLmtleXMocmVzdWx0cyksIF8udmFsdWVzKHJlc3VsdHMpKSwgZnVuY3Rpb24odmFsdWUpIHsKICAgIHJldHVybiB7CiAgICAgIGNpdHk6IHZhbHVlWzBdLCAKICAgICAgbGVhZF9jb3VudDogdmFsdWVbMV0KICAgIH07CiAgfSk7CgogIHN1bW1hcnlCeUNpdHlEYXRhID0gXy5tYXAocmVzdWx0cywgZnVuY3Rpb24oY2l0eURhdGFQb2ludCkgewogICAgcmV0dXJuIHsKICAgICAgdmFsdWU6IGNpdHlEYXRhUG9pbnQubGVhZF9jb3VudCwKICAgICAgY29sb3I6ICdoc2woJyArICgxODAgKiBjaXR5RGF0YVBvaW50LmxlYWRfY291bnQvIHJlc3VsdHMubGVuZ3RoKSAKICAgICAgICArICcsIDEwMCUsIDUwJSknLAogICAgICBsYWJlbDogY2l0eURhdGFQb2ludC5jaXR5CiAgICB9OwogIH0pOwoKICB2YXIgYnlDaXR5Q29udGV4dCA9ICQoIiNwaWUtYnktY2l0eSIpLmdldCgwKS5nZXRDb250ZXh0KCIyZCIpOwogIHZhciBieUNpdHlDaGFydCA9IG5ldyBDaGFydChieUNpdHlDb250ZXh0KS5QaWUoc3VtbWFyeUJ5Q2l0eURhdGEpOwp9KTsK</textarea>
</div>
</div><div class="saurus-overview"><ul></ul></div></div><div class="saurus-code"><div class="file-path"><span class="crumb-container"></span><i class="fa fa-fw fa-folder"></i></div><div class="saurus-editor"></div></div><div class="saurus-explorer"><div class="saurus-file-list"></div><a href="https://github.com/TwilioDevEd/call-tracking-node" target="_blank" class="explorer-get-code"> <i class="fa fa-lg fa-github-square"> </i>View Code on GitHub</a></div></div></div></div><script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script><script src="//cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore-min.js"></script><script src="//cdnjs.cloudflare.com/ajax/libs/backbone.js/1.1.2/backbone-min.js"></script><script src="ace/ace.js"></script><script src="ace/theme-monokai.js"></script><script src="viewsaurus.js"></script></body></html>